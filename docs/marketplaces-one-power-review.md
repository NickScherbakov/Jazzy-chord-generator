# Разбор `marketplaces-one-power` для джуна 1С Франчайзи

## Что удалось проверить

- Репозиторий по ссылке `https://github.com/NAScherba71/marketplaces-one-power` сейчас недоступен из текущего окружения (GitHub возвращает `404 Not Found`, а `git clone` не проходит без авторизации).
- Поэтому детальный разбор исходников (модули, объекты метаданных, обмены, очереди, API маркетплейсов) сделать технически нельзя без доступа к коду.

## Как читать такой проект в 1С (практический чек-лист)

Ниже — план, по которому обычно разбирают интеграции с маркетплейсами (Ozon/WB/Я.Маркет и т.д.) в проектах франча.

1. **Определи точку входа интеграции**
   - Общие модули: что запускает обмен (`ВыполнитьОбмен`, `ЗагрузитьЗаказы`, `ВыгрузитьОстатки`).
   - Регламентные задания: что крутится по расписанию.

2. **Найди модель данных**
   - Справочники: маркетплейсы, склады, кабинеты/токены API, соответствия номенклатуры.
   - Документы: заказы маркетплейса, отгрузки, возвраты.
   - Регистры сведений: статусы обмена, маппинги, ошибки API.

3. **Посмотри слой интеграции (HTTP/JSON)**
   - Где формируются HTTP-запросы (`HTTPЗапрос`, `HTTPСоединение`).
   - Где сериализация/десериализация JSON (`ЗаписьJSON`, `ЧтениеJSON`).
   - Как обрабатываются коды ответов 4xx/5xx и ретраи.

4. **Раздели бизнес-логику и технический транспорт**
   - Хороший признак: отдельно «получить данные из API», отдельно «создать документы в 1С».
   - Плохой признак: всё в одном длинном модуле без явных границ.

5. **Проверь идемпотентность**
   - Повторная загрузка заказа не должна дублировать документ.
   - Должны быть внешние идентификаторы и контроль уникальности.

6. **Проверь транзакции и блокировки**
   - Где используются `НачатьТранзакцию()/ЗафиксироватьТранзакцию()`.
   - Нет ли длинных транзакций с HTTP внутри.

7. **Проверь журналирование и поддержку**
   - Как пишутся ошибки (ЖР, регистр ошибок, лог-файл).
   - Можно ли быстро понять: какой кабинет, какой заказ, какой endpoint упал.

8. **Проверь расширяемость**
   - Есть ли общий интерфейс «маркетплейс-провайдера».
   - Насколько просто добавить новый маркетплейс без копипасты.

## Что спросить у старшего разработчика по этому проекту

- Где хранится «источник истины» по статусу заказа: 1С или маркетплейс?
- Как решаются гонки статусов (отмена/сборка/отгрузка)?
- Какой SLA по обмену и как мониторится отставание?
- Что происходит при лимитах API (429) и временной недоступности?
- Как организованы миграции при обновлении структуры данных?

## Антипаттерны, которые джуну важно уметь замечать

- Один огромный общий модуль «на всё».
- Жёстко зашитые URL/токены в коде.
- Отсутствие централизованной обработки ошибок API.
- Дублирование логики по маркетплейсам вместо общей абстракции.
- Отсутствие контроля повторной обработки (идемпотентности).

## Как я могу продолжить разбор

Если дашь доступ к репозиторию (или архив/выгрузку), я сделаю точечный разбор:

- карта модулей и объектов метаданных;
- полный flow «заказ -> документ 1С -> статус обратно в маркетплейс»;
- список технических рисков и приоритетный план рефакторинга;
- рекомендации «что джуну можно безопасно брать в работу первым».
